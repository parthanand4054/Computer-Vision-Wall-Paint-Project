#!/bin/bash

# Save response to file
curl -s --location 'https://developer.api.us.stg.walmart.com/api-proxy/service/COMPASS/SERVICE/v4/embeddings/upc?upc_id=7062240121' \
--header 'wm_consumer.id: c061c52a-b978-4ae9-9875-6584e58e8a74' \
--header 'Authorization: Bearer eyJraWQiOiJKOTY5MzBhY...' \
--output response.gz

# Check if file was downloaded
if [ ! -f response.gz ]; then
    echo "Failed to download file"
    exit 1
fi

# Try to decompress
gunzip -f response.gz

# Check if decompression was successful
if [ -f response ]; then
    echo "Successfully decompressed response."
    echo "First few lines of the response:"
    head -n 20 response
    echo "..."
    echo "Full response saved to 'response' file"
else
    echo "Failed to decompress response"
fi
